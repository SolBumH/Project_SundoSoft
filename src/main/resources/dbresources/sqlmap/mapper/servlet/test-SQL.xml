<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="test">
	<select id="getCDBFunction" resultType="Long">
		select unnest(cdb_jenksbins(array_agg("usage"), 5)) as natural
    from b5_sd_view bsv 
	</select>
	<select id="getCDBFunction2" resultType="map">
		select cdb_jenksbins(array_agg("usage"), 5)
		from b5_sd_view bsv 
	</select>
	
	<insert id="dbTest3" parameterType="list">
		insert into "TB_CARBON_B5"
		values
		<foreach collection="list" item="list" index="index" separator=",">
			(#{list.yearMonthUse},#{list.landLocation}, #{list.roadLandLocation}
			, #{list.sggCode}, #{list.bjdCode}, #{list.landCode}, #{list.bun}
			, #{list.ji}, #{list.newAddNumber}, #{list.newRoadCode}
			, #{list.newLandCode}, #{list.newbonbeon}, #{list.newbubeon}
			, #{list.usage})
		</foreach>
	</insert>
</mapper>